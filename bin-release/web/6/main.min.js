var GameOver=function(t){function e(e,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1),t.call(this,e,i,s),this._type=0,this._goNum=0}__extends(e,t);var i=(__define,e);i.prototype;return e.DATE="结束",e}(egret.Event);egret.registerClass(GameOver,"GameOver");var LoadingUI=function(t){function e(){t.call(this),this.createView()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=640,this.textField.height=100,this.textField.textAlign="center"},s.setProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);egret.registerClass(LoadingUI,"LoadingUI");var Main=function(t){function e(){t.call(this),this.addEventListener(egret.Event.ADDED_TO_STAGE,this.onAddToStage,this)}__extends(e,t);var i=(__define,e),s=i.prototype;return s.onAddToStage=function(t){this.loadingView=new LoadingUI,this.stage.addChild(this.loadingView),RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.loadConfig("resource/default.res.json","resource/")},s.onConfigComplete=function(t){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),RES.loadGroup("preload")},s.onResourceLoadComplete=function(t){"preload"==t.groupName&&(this.stage.removeChild(this.loadingView),RES.removeEventListener(RES.ResourceEvent.GROUP_COMPLETE,this.onResourceLoadComplete,this),RES.removeEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,this.onResourceLoadError,this),RES.removeEventListener(RES.ResourceEvent.GROUP_PROGRESS,this.onResourceProgress,this),RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,this.onItemLoadError,this),this.createGameScene())},s.onItemLoadError=function(t){console.warn("Url:"+t.resItem.url+" has failed to load")},s.onResourceLoadError=function(t){console.warn("Group:"+t.groupName+" has failed to load"),this.onResourceLoadComplete(t)},s.onResourceProgress=function(t){"preload"==t.groupName&&this.loadingView.setProgress(t.itemsLoaded,t.itemsTotal)},s.getData=function(t){this.lose=new Lose,this.lose.width=640,this.lose.height=1080,this.lose.x=0,this.lose.y=0,this.stage.addChild(this.lose);var e=t._type,i=t._goNum;this.lose.setValue(e,i),this.lose.beginBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.goAgain,this)},s.goAgain=function(){this.stage.removeChild(this.lose),this.stage.removeChild(this.admin),document.title="双船快划",this.createGameScene()},s.createGameScene=function(){this.admin=new Admin,this.admin.width=640,this.admin.height=1080,this.stage.addChild(this.admin),this.welcom=new Welcom,this.welcom.width=640,this.welcom.height=1080,this.stage.addChild(this.welcom),this.welcom.begin(),this.welcom.herdBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.herdTouch,this),this.welcom.medioBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.medioTouch,this),this.welcom.easyBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.easyTouch,this),this.admin.addEventListener(GameOver.DATE,this.getData,this)},s.herdTouch=function(t){this.welcom.end(),this.stage.removeChild(this.welcom);var e=Math.floor(2*Math.random())+1;this.admin.setValue(e,10),this.admin.begin()},s.medioTouch=function(t){this.welcom.end(),this.stage.removeChild(this.welcom),this.admin.setValue(0,8),this.admin.begin()},s.easyTouch=function(t){this.welcom.end(),this.stage.removeChild(this.welcom),this.admin.setValue(0,5),this.admin.begin()},s.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},s.startAnimation=function(t){for(var e=this,i=new egret.HtmlTextParser,s=[],h=0;h<t.length;h++)s.push(i.parser(t[h]));var a=e.textfield,o=-1,n=function(){o++,o>=s.length&&(o=0);var t=s[o];e.changeDescription(a,t);var i=egret.Tween.get(a);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(n,e)};n()},s.changeDescription=function(t,e){t.textFlow=e},e}(egret.DisplayObjectContainer);egret.registerClass(Main,"Main");var Admin=function(t){function e(){t.call(this),this.gameOver=new GameOver(GameOver.DATE),this.goNum=0,this.leftRoad=1e3,this.RightRoad=1e3,this.timer=new egret.Timer(10,0),this.timer.addEventListener(egret.TimerEvent.TIMER,this.timerFunc,this),this.timer.addEventListener(egret.TimerEvent.TIMER_COMPLETE,this.timerComFunc,this),this.show()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.show=function(){var t=new egret.Shape;t.graphics.beginFill(6737151,1),t.graphics.drawRect(0,0,640,1080),t.graphics.endFill(),this.addChild(t);var e=new egret.Shape;e.graphics.lineStyle(8,13395507),e.graphics.moveTo(320,0),e.graphics.lineTo(320,1080),e.graphics.endFill(),this.addChild(e);var i=new egret.Shape;i.graphics.lineStyle(4,16764006),i.graphics.moveTo(158,0),i.graphics.lineTo(158,1080),i.graphics.endFill(),this.addChild(i);var s=new egret.Shape;s.graphics.lineStyle(4,16764006),s.graphics.moveTo(478,0),s.graphics.lineTo(478,1080),s.graphics.endFill(),this.addChild(s),this.blueBoat=new Boat;var h=6737151,a="blueBoat_png";this.blueBoat.SetTitle(h,a),this.blueBoat.width=156,this.blueBoat.height=200,this.blueBoat.x=0,this.blueBoat.y=830,this.addChild(this.blueBoat),this.redBoat=new Boat;var h=6737151,a="redBoat_png";this.redBoat.SetTitle(h,a),this.redBoat.width=156,this.redBoat.height=200,this.redBoat.x=324,this.redBoat.y=830,this.addChild(this.redBoat),this.numLabel=new egret.TextField,this.numLabel.text=""+this.goNum,this.numLabel.textAlign="right",this.numLabel.width=320,this.numLabel.height=40,this.numLabel.size=38,this.numLabel.x=320,this.numLabel.y=0,this.addChild(this.numLabel),this.leftTouchBar=new egret.Shape,this.leftTouchBar.graphics.beginFill(16711680,0),this.leftTouchBar.graphics.drawRect(0,0,320,1080),this.leftTouchBar.graphics.endFill(),this.addChild(this.leftTouchBar),this.leftTouchBar.addEventListener(egret.TouchEvent.TOUCH_TAP,this.leftTouch,this),this.rightTouchBar=new egret.Shape,this.rightTouchBar.graphics.beginFill(16711680,0),this.rightTouchBar.graphics.drawRect(0,0,320,1080),this.rightTouchBar.x=320,this.rightTouchBar.graphics.endFill(),this.addChild(this.rightTouchBar),this.rightTouchBar.addEventListener(egret.TouchEvent.TOUCH_TAP,this.rightTouch,this),this.barArray=new Array;for(var o=0;5>o;o++){var n=new Bar;this.barArray[o]=n,this.addChild(n)}},s.rightTouch=function(){if(324==this.redBoat.x){var t=egret.Tween.get(this.redBoat);t.to({x:476},200)}else if(476==this.redBoat.x){var t=egret.Tween.get(this.redBoat);t.to({x:324},200)}},s.leftTouch=function(){if(0==this.blueBoat.x){var t=egret.Tween.get(this.blueBoat);t.to({x:156},200)}else if(156==this.blueBoat.x){var t=egret.Tween.get(this.blueBoat);t.to({x:0},200)}},s.work=function(){this.timer.start()},s.timerFunc=function(){this.goNum=this.goNum+this.speedUp,this.numLabel.text=""+this.goNum,this.leftRoad=this.leftRoad+this.addUp,this.RightRoad=this.RightRoad+this.addUp;for(var t=0;t<this.barArray.length;t++){var e=this.barArray[t],i=e.getState();if(e.width=80,e.height=80,0==i){var s=Math.floor(2*Math.random())+1;if(1==s){if(this.leftRoad>1200/this.barArray.length*2){e.setRoad(1),e.setState(1),this.leftRoad=0;var h=Math.floor(2*Math.random())+1;e.setType(h),1==h?e.setImage("blueBox_png"):e.setImage("blueHeart_png");var a=Math.floor(2*Math.random())+1;1==a?e.x=38:e.x=194,1==this.boatState?e.y=1160:e.y=-80}}else if(this.RightRoad>1160/this.barArray.length*2){e.setRoad(2),e.setState(1),this.RightRoad=0;var h=Math.floor(2*Math.random())+1;e.setType(h),1==h?e.setImage("redBox_png"):e.setImage("redHeart_png");var a=Math.floor(2*Math.random())+1;1==a?e.x=358:e.x=514,2==this.boatState?e.y=1160:e.y=-80}}var a=e.getRoad();1==a&&1==this.boatState||2==a&&2==this.boatState?(e.y=e.y-this.addUp,e.y<-80&&e.setState(0)):(e.y=e.y+this.addUp,e.y>1160&&e.setState(0));var o=e.getType(),n=e.getRoad();1==i&&(1==n?1==this.boatState?38==e.x&&this.blueBoat.x<118&&e.y<250&&e.y>-0?1==o?(console.log("top blue left box"),this.lose()):e.setState(0):194==e.x&&this.blueBoat.x>38&&this.blueBoat.x<274&&e.y<250&&e.y>0&&(1==o?(console.log("top blue left box"),this.lose()):e.setState(0)):38==e.x&&this.blueBoat.x<118&&e.y<1e3&&e.y>760?1==o?(console.log("top blue left box"),this.lose()):e.setState(0):194==e.x&&this.blueBoat.x>38&&this.blueBoat.x<274&&e.y<1e3&&e.y>760&&(1==o?(console.log("top blue left box"),this.lose()):e.setState(0)):2==n&&(2==this.boatState?358==e.x&&this.redBoat.x<438&&e.y<250&&e.y>0?1==o?(console.log("top blue left box"),this.lose()):e.setState(0):514==e.x&&this.redBoat.x>358&&this.redBoat.x<594&&e.y<250&&e.y>0&&(1==o?(console.log("top blue left box"),this.lose()):e.setState(0)):358==e.x&&this.redBoat.x<438&&e.y<1e3&&e.y>760?1==o?(console.log("top blue left box"),this.lose()):e.setState(0):514==e.x&&this.redBoat.x>358&&this.redBoat.x<594&&e.y<1e3&&e.y>760&&(1==o?(console.log("top blue left box"),this.lose()):e.setState(0))));var r=e.getState();1==r&&2==o&&(1==this.boatState?e.x<310?e.y<0&&(console.log("heart out top"),this.lose()):e.y>1e3&&(console.log("heart out down"),this.lose()):2==this.boatState&&e.x>310?e.y<0&&(console.log("heart out top"),this.lose()):e.y>1e3&&(console.log("heart out down"),this.lose()))}var d=this.goNum/1e3-5+this.speedUp;this.addUp<15&&this.addUp<d&&(this.addUp=d)},s.timerComFunc=function(){console.log("计时结束")},s.lose=function(){this.timer.stop(),this.blueBoat.touchEnabled=!1,this.redBoat.touchEnabled=!1,this.gameOver._type=this.speedUp,this.gameOver._goNum=this.goNum,this.dispatchEvent(this.gameOver)},s.setValue=function(t,e){this.boatState=t,this.speedUp=e,this.addUp=e},s.begin=function(){if(this.removeChildren,this.show(),1==this.boatState){this.blueBoat.y=50;var t=6737151,e="blueBoatDown_png";this.blueBoat.SetTitle(t,e)}else if(2==this.boatState){this.redBoat.y=50;var t=6737151,e="redBoatDown_png";this.redBoat.SetTitle(t,e)}else if(3==this.boatState){this.blueBoat.y=50,this.redBoat.y=50;var t=6737151,e="blueBoatDown_png";this.blueBoat.SetTitle(t,e);var e="redBoatDown_png";this.redBoat.SetTitle(t,e)}this.rightTouchBar.touchEnabled=!0,this.leftTouchBar.touchEnabled=!0,this.work()},s.end=function(){this.show(),this.rightTouchBar.touchEnabled=!1,this.leftTouchBar.touchEnabled=!1},e}(egret.Sprite);egret.registerClass(Admin,"Admin");var Bar=function(t){function e(){t.call(this),this.state=0,this.road=0,this.show()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.show=function(){this.backImage=new egret.Bitmap,this.backImage.texture=RES.getRes(this.imageName),this.addChild(this.backImage)},s.setImage=function(t){this.imageName=t,this.backImage.texture=RES.getRes(this.imageName)},s.getImage=function(){return this.imageName},s.setState=function(t){0==t?this.backImage.texture=RES.getRes(""):this.backImage.texture=RES.getRes(this.imageName),this.state=t},s.setType=function(t){this.type=t},s.setRoad=function(t){this.road=t},s.getRoad=function(){return this.road},s.getType=function(){return this.type},s.getState=function(){return this.state},e}(egret.Sprite);egret.registerClass(Bar,"Bar");var Boat=function(t){function e(){t.call(this),this.show()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.show=function(){this.backImage=new egret.Bitmap,this.backImage.texture=RES.getRes(this.imageName),this.addChild(this.backImage)},s.SetTitle=function(t,e){this.color=t,this.imageName=e,this.backImage.texture=RES.getRes(this.imageName)},e}(egret.Sprite);egret.registerClass(Boat,"Boat");var Lose=function(t){function e(){t.call(this),this.show()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.9),t.graphics.drawRect(0,0,640,1080),t.graphics.endFill(),this.addChild(t),this.title=new egret.TextField,this.title.width=560,this.title.height=200,this.title.size=58,this.title.text="鼓励语",this.title.textAlign="center",this.title.x=40,this.title.y=200,this.addChild(this.title),this.beginBtn=new egret.TextField,this.beginBtn.width=640,this.beginBtn.height=50,this.beginBtn.size=42,this.beginBtn.text="重新开始",this.beginBtn.textAlign="center",this.beginBtn.x=0,this.beginBtn.y=450,this.addChild(this.beginBtn),this.beginBtn.touchEnabled=!0},s.setValue=function(t,e){var i="";5==t?i="简单":8==t?i="中等":10==t&&(i="困难"),document.title="我在"+i+"难度下跑了 "+e+"分！ 快来挑战我！",this.title.text="您在"+i+"难度下跑了 "+e+"分！ 再接再厉！"},e}(egret.Sprite);egret.registerClass(Lose,"Lose");var Welcom=function(t){function e(){t.call(this),this.show()}__extends(e,t);var i=(__define,e),s=i.prototype;return s.show=function(){var t=new egret.Shape;t.graphics.beginFill(0,.9),t.graphics.drawRect(0,0,640,1080),t.graphics.endFill(),this.addChild(t);var e=new egret.TextField;e.width=640,e.height=70,e.size=58,e.text="双船快划",e.textAlign="center",e.x=0,e.y=200,this.addChild(e);var i=new egret.TextField;i.width=560,i.height=150,i.size=38,i.text="点击控制小船左右移动，躲避盒子，撞击心",i.textAlign="center",i.x=40,i.y=350,this.addChild(i),this.herdBtn=new egret.TextField,this.herdBtn.width=640,this.herdBtn.height=50,this.herdBtn.size=42,this.herdBtn.text="困难",this.herdBtn.textAlign="center",this.herdBtn.x=0,this.herdBtn.y=500,this.addChild(this.herdBtn),this.medioBtn=new egret.TextField,this.medioBtn.width=640,this.medioBtn.height=50,this.medioBtn.size=42,this.medioBtn.text="中等",this.medioBtn.textAlign="center",this.medioBtn.x=0,this.medioBtn.y=600,this.addChild(this.medioBtn),this.easyBtn=new egret.TextField,this.easyBtn.width=640,this.easyBtn.height=50,this.easyBtn.size=42,this.easyBtn.text="简单",this.easyBtn.textAlign="center",this.easyBtn.x=0,this.easyBtn.y=700,this.addChild(this.easyBtn)},s.begin=function(){this.herdBtn.touchEnabled=!0,this.medioBtn.touchEnabled=!0,this.easyBtn.touchEnabled=!0},s.end=function(){this.herdBtn.touchEnabled=!1,this.medioBtn.touchEnabled=!1,this.easyBtn.touchEnabled=!1},e}(egret.Sprite);egret.registerClass(Welcom,"Welcom");